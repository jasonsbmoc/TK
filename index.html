<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abstract Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter&family=Newsreader:opsz,wght@6..72,400&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #F5F6F4;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: system-ui, sans-serif;
        }

        .frame {
            position: relative;
            width: 100px;
            height: 100px;
        }

        .frame img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .prompt {
            font-family: 'Newsreader', serif;
            font-weight: 400;
            font-optical-sizing: none;
            font-size: 16px;
            color: #333;
            width: 300px;
            height: 88px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            line-height: 1.4;
            margin-top: 24px;
        }

        .controls {
            display: flex;
            gap: 8px;
            margin-top: 24px;
        }

        button {
            padding: 8px;
            cursor: pointer;
            border: none;
            background: transparent;
        }

        button:hover {
            opacity: 0.6;
        }

        button svg {
            width: 16px;
            height: 16px;
        }

        .alert {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            color: #aaa;
            margin-top: 16px;
            opacity: 0;
            transition: opacity 0.15s ease-in;
        }

        .alert.visible {
            opacity: 1;
        }

        .alert.fade-out {
            opacity: 0;
            transition: opacity 0.5s ease-out;
        }
    </style>
</head>
<body>
    <div class="frame" id="frame"></div>
    <div class="prompt" id="prompt"></div>
    <div class="controls">
        <button onclick="generate()">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/>
                <path d="M21 3v5h-5"/>
            </svg>
        </button>
        <button onclick="copyToClipboard()">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
            </svg>
        </button>
    </div>
    <div class="alert" id="alert">Copied to clipboard</div>

    <script>
        const sets = {
            A: [1, 2, 3, 4, 5, 6],
            B: [1, 2, 3, 4, 5, 6],
            C: [1, 2, 3, 4, 5, 6],
            D: [1, 2, 3, 4, 5, 6],
            E: [1, 2, 3, 4, 5, 6]
        };

        const prompts = [
            "Begin with the sentence that scares you the most.",
            "Introduce a detail that doesn't belong, then insist that it does.",
            "Write the ending before the problem.",
            "Annotate your doubt.",
            "Replace one clean conclusion with a strange question.",
            "Make one assumption visible, then refuse to defend it.",
            "Follow the tangent that feels least productive.",
            "Explain the idea as if you disagree with it.",
            "Invert your emphasis: highlight what you usually ignore.",
            "Let the piece become more ambiguous than you planned.",
            "Describe the shape of your confusion.",
            "Remove the most polished sentence and keep the gap.",
            "Name the thing you're avoiding naming.",
            "Write one paragraph backwards (idea → cause, not cause → idea).",
            "Choose a sentence and write its shadow version.",
            "Write the version you'd be embarrassed to show anyone. Keep the embarrassing part.",
            "State your argument, then ask what it's protecting you from.",
            "Find the word you've used three times without noticing. That's the essay.",
            "Write one sentence as if you already know the answer. Write the next as if you don't.",
            "Borrow the structure of something that isn't writing — a recipe, a diagnosis, a set of instructions — and pour your idea into it.",
            "Identify the moment your thinking got comfortable. Start over from just before that.",
            "Write toward the reader you most want to avoid.",
            "Say the obvious thing. Then ask why it needed to be said.",
            "Let two contradictory observations stand without resolving them. Move on.",
            "Find the transition you wrote too quickly. That's where the real work is."
        ];

        function getRandomFromSet(letter) {
            const numbers = sets[letter];
            const randomIndex = Math.floor(Math.random() * numbers.length);
            return `Images/${letter}-${numbers[randomIndex]}.png`;
        }

        let alertTimeout;

        function hideAlert() {
            const alert = document.getElementById('alert');
            alert.classList.remove('visible');
            alert.classList.remove('fade-out');
            if (alertTimeout) clearTimeout(alertTimeout);
        }

        function generate() {
            hideAlert();
            const frame = document.getElementById('frame');
            frame.innerHTML = '';

            const layers = ['A', 'B', 'C', 'D', 'E'];

            layers.forEach((letter, index) => {
                const img = document.createElement('img');
                img.crossOrigin = 'anonymous';
                img.src = getRandomFromSet(letter);
                img.style.zIndex = index;
                frame.appendChild(img);
            });

            // Set random prompt
            const promptEl = document.getElementById('prompt');
            const randomPrompt = prompts[Math.floor(Math.random() * prompts.length)];
            promptEl.textContent = randomPrompt;
        }

        async function copyToClipboard() {
            const frame = document.getElementById('frame');
            const images = frame.querySelectorAll('img');

            const canvas = document.createElement('canvas');
            canvas.width = 100;
            canvas.height = 100;
            const ctx = canvas.getContext('2d');

            // Draw each layer in order
            for (const img of images) {
                ctx.drawImage(img, 0, 0, 100, 100);
            }

            // Convert to blob and copy to clipboard
            canvas.toBlob(async (blob) => {
                try {
                    await navigator.clipboard.write([
                        new ClipboardItem({ 'image/png': blob })
                    ]);
                    showAlert();
                } catch (err) {
                    console.error('Failed to copy:', err);
                }
            }, 'image/png');
        }

        function showAlert() {
            const alert = document.getElementById('alert');
            if (alertTimeout) clearTimeout(alertTimeout);
            alert.classList.remove('fade-out');
            alert.classList.add('visible');

            alertTimeout = setTimeout(() => {
                alert.classList.add('fade-out');
            }, 2000);
        }

        // Generate on page load
        generate();
    </script>
</body>
</html>
